{% if user_type %} 
{% set back_link = 'system_admin/hx/tab?tab=GroupList' %} {# Systems Admin #}
{% set target_panel = 'system_admin_group' %}
{% else %}
{% set back_link = 'group_admin/hx/tab?tab=Main' %}
{% set target_panel = 'group_admin_panel' %}
{% endif %}

<div class="section-header flex flex-row">
	<a hx-get="{{ back_link }}" hx-target="#{{ target_panel }}" class="cb-link">Group Management</a>
	&nbsp;&nbsp;&rsaquo;&nbsp;
	{{ group | capitalize }}
</div>
<button type="submit" class="cb_button secondary" hx-get="system_admin/hx/tab?tab=GroupModify&group={{ group }}" hx-target="#system_admin_group">
	Subscriptions
</button>
<table class="table-display mt-4">
	<thead>
		<tr>
			<th scope="col" class="max-lg:hidden">
				Name
			</th>
			<th scope="col">
				Email
			</th>
			<th scope="col" class="max-sm:hidden">
				Updated
			</th>
			<th scope="col">
				Actions
			</th>
		</tr>
	</thead>
	<tbody>
		{% if group_members %}
		{% for user in group_members %}
		<tr>
			<td class="max-lg:hidden">
				{{ user.user_name }}
			</td>
			<td>
				{{ user.email }}
			</td>
			<td class="max-sm:hidden" title="{{ user.updated_at }}">
				{{ user.updated_at | time_ago }}
			</td>
			<td id="_{{ user.sub | slugify }}_remove">
				<button class="font-medium text-red-600 dark:text-red-500 cursor-pointer" hx-patch="group_admin/hx/user"
					hx-vals='{"email": "{{ user.email }}", "group_name": "{{ group }}", "modify_user": "remove", "last_updated_by": "{{ group_admin }}"}'
					hx-target="#_{{ user.sub | slugify }}_remove" hx-swap="outerhtml"
					hx-confirm="Are you sure you wish to remove {{ user.email }}?">
					Remove
				</button>
			</td>
		</tr>
		{% endfor %}
		{% else %}
		<tr>
			<td colspan="4" class="py-4 px-6 text-center text-gray-500 dark:text-gray-400">
				No users found.
			</td>
		</tr>
		{% endif %}
	</tbody>
</table>
